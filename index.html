<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Football Team Manager</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="dark-theme">
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-futbol"></i>
                    <h1>Team Manager</h1>
                </div>
                <div class="header-controls">
                    <button class="btn btn-secondary" id="tacticalModeBtn">
                        <i class="fas fa-draw-polygon"></i>
                        Modalit√† Tattica
                    </button>
                    <button class="btn btn-danger" id="clearFieldBtn">
                        <i class="fas fa-broom"></i>
                        Clear Field
                    </button>
                    <button class="btn btn-primary" id="playerManagementBtn">
                        <i class="fas fa-users"></i>
                        Gestione Giocatori
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-section">
                    <h3>Team Settings</h3>
                    <div class="form-group">
                        <label for="teamDisplayMode">Modalit√† Visualizzazione Squadra</label>
                        <select id="teamDisplayMode">
                            <option value="all">Tutte le squadre</option>
                            <option value="1">1 squadra</option>
                            <option value="2">2 squadre</option>
                        </select>
                    </div>
                    
                    <!-- Dynamic Squad Selection Sections -->
                    <div id="squadSelectionsContainer">
                        <!-- Squad selections will be dynamically added here -->
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3>Player Pool</h3>
                    <div class="player-filters">
                        <div class="form-group">
                            <label for="playerSquadFilter">Filtra per Squadra</label>
                            <select id="playerSquadFilter">
                                <option value="">All Squads</option>
                                <option value="alpak">Alpak</option>
                                <option value="bigbro">Big Bro</option>
                                <option value="boomers">Boomers</option>
                                <option value="caesar">Caesar</option>
                                <option value="circus">Circus</option>
                                <option value="d power">D Power</option>
                                <option value="fc zeta">FC Zeta</option>
                                <option value="gear 7">Gear 7</option>
                                <option value="stallions">Stallions</option>
                                <option value="trm fc">TRM FC</option>
                                <option value="underdogs fc">Underdogs FC</option>
                                <option value="zebras fc">Zebras FC</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="playerNameFilter">Filtra per Nome</label>
                            <input type="text" id="playerNameFilter" placeholder="Search player name...">
                        </div>
                        <div class="form-group">
                            <label for="playerPositionFilter">Filtra per Posizione</label>
                            <select id="playerPositionFilter">
                                <option value="">All Positions</option>
                                <option value="PORTIERE">PORTIERE</option>
                                <option value="DIFENSORE">DIFENSORE</option>
                                <option value="CENTROCAMPISTA">CENTROCAMPISTA</option>
                                <option value="ATTACCANTE">ATTACCANTE</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="roleToggleBtn">Visualizzazione Ruoli</label>
                            <button id="roleToggleBtn" class="role-toggle-btn" title="Clicca per mostrare/nascondere i ruoli dei giocatori">
                                <i class="fas fa-eye"></i>
                                <span class="toggle-text">ON</span>
                            </button>
                        </div>
                        <div class="form-group">
                            <label for="gridViewBtn">Vista Griglia</label>
                            <button id="gridViewBtn" class="btn btn-primary grid-view-btn" title="Apri vista griglia per selezione multipla">
                                <i class="fas fa-th"></i>
                                Grid View
                            </button>
                        </div>
                    </div>
                    <div class="player-pool" id="playerPool">
                        <!-- Player cards will be dynamically added here -->
                    </div>
                </div>
            </aside>

            <!-- Field Area -->
            <div class="field-container">
                <!-- Tactical Drawing Tools Panel -->
                <div class="tactical-tools-panel" id="tacticalToolsPanel" style="display: none;">
                    <div class="tools-header">
                        <h3><i class="fas fa-palette"></i> Strumenti Tattici</h3>
                        <div class="header-buttons">
                            <button class="btn btn-sm btn-info" id="tacticalInfoBtn" title="Informazioni e Guida">
                                <i class="fas fa-info-circle"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" id="closeTacticalMode">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="tools-section">
                        <h4>Strumenti di Disegno</h4>
                        <div class="tool-buttons">
                            <button class="tool-btn active" data-tool="select" title="Seleziona">
                                <i class="fas fa-mouse-pointer"></i>
                            </button>
                            <button class="tool-btn" data-tool="line" title="Linea">
                                <i class="fas fa-minus"></i>
                            </button>
                            <button class="tool-btn" data-tool="arrow" title="Freccia">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                            <button class="tool-btn" data-tool="circle" title="Cerchio">
                                <i class="fas fa-circle"></i>
                            </button>
                            <button class="tool-btn" data-tool="rectangle" title="Rettangolo">
                                <i class="fas fa-square"></i>
                            </button>
                            <button class="tool-btn" data-tool="text" title="Testo">
                                <i class="fas fa-font"></i>
                            </button>
                            <button class="tool-btn" data-tool="pen" title="Penna - Disegno a mano libera">
                                <i class="fas fa-pen"></i>
                            </button>
                            <button class="tool-btn" data-tool="eraser" title="Gomma - Cancella elementi">
                                <i class="fas fa-eraser"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="tools-section">
                        <h4>Propriet√†</h4>
                        <div class="form-group">
                            <label for="strokeColor">Colore</label>
                            <input type="color" id="strokeColor" value="#ff0000">
                        </div>
                        <div class="form-group">
                            <label for="strokeWidth">Spessore</label>
                            <input type="range" id="strokeWidth" min="1" max="10" value="3">
                            <span id="strokeWidthValue">3px</span>
                        </div>
                        <div class="form-group">
                            <label for="fillColor">Riempimento</label>
                            <input type="color" id="fillColor" value="#ffffff">
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="fillEnabled"> Abilita riempimento
                            </label>
                        </div>
                    </div>
                    
                    <div class="tools-section">
                        <h4>Azioni</h4>
                        <div class="action-buttons">
                            <button class="btn btn-sm btn-secondary" id="undoBtn" title="Annulla">
                                <i class="fas fa-undo"></i>
                            </button>
                            <button class="btn btn-sm btn-secondary" id="redoBtn" title="Ripeti">
                                <i class="fas fa-redo"></i>
                            </button>
                            <button class="btn btn-sm btn-warning" id="clearDrawingBtn" title="Cancella tutto">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>

                    </div>
                </div>
                
                <div class="field" id="footballField">
                    <!-- SVG Canvas for tactical drawings -->
                    <svg class="tactical-canvas" id="tacticalCanvas" style="display: none;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                                    refX="9" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="currentColor" />
                            </marker>
                        </defs>
                    </svg>
                    
                    <!-- Field markings removed to avoid overlap with campo.png background -->
                    
                    <!-- Drop zones for different positions -->
                    <div class="position-zone goalkeeper-zone" data-position="GK">
                        <span class="zone-label">GK</span>
                    </div>
                    
                    <div class="position-zone defender-zone" data-position="DEF">
                        <span class="zone-label">Defenders</span>
                    </div>
                    
                    <div class="position-zone midfielder-zone" data-position="MID">
                        <span class="zone-label">Midfielders</span>
                    </div>
                    
                    <div class="position-zone forward-zone" data-position="FWD">
                        <span class="zone-label">Forwards</span>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Tactical Scheme Save/Load Modal -->
    <div class="modal" id="schemeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="schemeModalTitle">Gestione Schemi Tattici</h2>
                <button class="modal-close" id="schemeModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="scheme-actions">
                    <div class="form-group">
                        <label for="schemeName">Nome Schema</label>
                        <input type="text" id="schemeName" placeholder="Inserisci nome schema...">
                    </div>
                    <div class="saved-schemes">
                        <h4>Schemi Salvati</h4>
                        <div id="savedSchemesList">
                            <!-- Lista schemi salvati -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelSchemeBtn">Annulla</button>
                <button type="button" class="btn btn-success" id="saveSchemeConfirmBtn">Salva Schema</button>
                <button type="button" class="btn btn-primary" id="loadSchemeConfirmBtn" style="display: none;">Carica Schema</button>
            </div>
        </div>
    </div>



    <!-- Player Management Modal -->
    <div class="modal" id="playerModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Aggiungi Giocatore</h2>
                <button class="modal-close" id="playerModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <!-- Aggiungi Giocatore Form -->
                <div class="tab-content active" id="addTab">
                    <form id="playerForm">
                        <div class="form-group">
                            <label for="playerName">Nome Giocatore</label>
                            <input type="text" id="playerName" required>
                        </div>
                        <div class="form-group">
                            <label for="playerPosition">Posizione</label>
                            <select id="playerPosition" required>
                                <option value="">Seleziona posizione</option>
                                <option value="PORTIERE">PORTIERE</option>
                                <option value="DIFENSORE">DIFENSORE</option>
                                <option value="CENTROCAMPISTA">CENTROCAMPISTA</option>
                                <option value="ATTACCANTE">ATTACCANTE</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="playerSquad">Squadra</label>
                            <select id="playerSquad" required>
                                <option value="">Seleziona squadra</option>
                                <option value="alpak">Alpak</option>
                                <option value="bigbro">Big Bro</option>
                                <option value="boomers">Boomers</option>
                                <option value="caesar">Caesar</option>
                                <option value="circus">Circus</option>
                                <option value="d power">D Power</option>
                                <option value="fc zeta">FC Zeta</option>
                                <option value="gear 7">Gear 7</option>
                                <option value="stallions">Stallions</option>
                                <option value="trm fc">TRM FC</option>
                                <option value="underdogs fc">Underdogs FC</option>
                                <option value="zebras fc">Zebras FC</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="playerWildcard">WILDCARD</label>
                            <select id="playerWildcard">
                                <option value="NO">NO</option>
                                <option value="SI">SI</option>
                            </select>
                        </div>
                        <input type="hidden" id="editingPlayerId" value="">
                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelPlayerBtn">Annulla</button>
                <button type="button" class="btn btn-success" id="savePlayerBtn">Salva Giocatore</button>
            </div>
        </div>
    </div>

    <!-- Scheme Management Modal -->
    <div class="modal" id="schemeModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Gestione Schemi Tattici</h2>
                <button class="modal-close" id="schemeModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="schemeName">Nome Schema</label>
                    <input type="text" id="schemeName" placeholder="Inserisci nome schema...">
                </div>
                <div class="saved-schemes">
                    <h4>Schemi Salvati</h4>
                    <div id="schemesList"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelSchemeBtn">Annulla</button>
                <button type="button" class="btn btn-success" id="saveSchemeConfirmBtn">Salva</button>
                <button type="button" class="btn btn-info" id="loadSchemeConfirmBtn">Carica</button>
            </div>
        </div>
    </div>

    <!-- Text Input Modal -->
    <div class="modal" id="textInputModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="textModalTitle">Inserisci Testo</h2>
                <button class="modal-close" id="textModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="textInput">Testo</label>
                    <input type="text" id="textInput" placeholder="Inserisci il testo...">
                </div>
                <div class="form-group">
                    <label for="textColorInput">Colore Testo</label>
                    <input type="color" id="textColorInput" value="#3b82f6">
                </div>
                <div class="form-group">
                    <label for="textSizeInput">Dimensione Testo (px)</label>
                    <input type="range" id="textSizeInput" min="8" max="72" value="16" step="1">
                    <span id="textSizeValue">16px</span>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" id="textModalDelete" style="display: none;">
                    <i class="fas fa-trash"></i>
                    Elimina
                </button>
                <button type="button" class="btn btn-secondary" id="textModalCancel">Annulla</button>
                <button type="button" class="btn btn-primary" id="textModalConfirm">Conferma</button>
            </div>
        </div>
    </div>

    <!-- Tactical Info Modal -->
    <div class="modal" id="tacticalInfoModal" style="display: none;">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2><i class="fas fa-info-circle"></i> Guida alla Modalit√† Tattica</h2>
                <button class="modal-close" id="tacticalInfoModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="info-section">
                    <h3><i class="fas fa-palette"></i> Strumenti di Disegno</h3>
                    <div class="tool-info">
                        <div class="tool-item">
                            <i class="fas fa-mouse-pointer"></i>
                            <div>
                                <strong>Seleziona:</strong> Clicca per selezionare e trascinare elementi esistenti. Usa <kbd>Canc</kbd> o <kbd>Backspace</kbd> per eliminare l'elemento selezionato.
                            </div>
                        </div>
                        <div class="tool-item">
                            <i class="fas fa-minus"></i>
                            <div>
                                <strong>Linea:</strong> Clicca e trascina per disegnare linee rette. Perfetto per indicare movimenti o posizioni.
                            </div>
                        </div>
                        <div class="tool-item">
                            <i class="fas fa-arrow-right"></i>
                            <div>
                                <strong>Freccia:</strong> Clicca e trascina per disegnare frecce direzionali. Ideale per indicare direzioni di movimento o passaggi.
                            </div>
                        </div>
                        <div class="tool-item">
                            <i class="fas fa-circle"></i>
                            <div>
                                <strong>Cerchio:</strong> Clicca e trascina per disegnare cerchi. Utile per evidenziare aree o posizioni specifiche.
                            </div>
                        </div>
                        <div class="tool-item">
                            <i class="fas fa-square"></i>
                            <div>
                                <strong>Rettangolo:</strong> Clicca e trascina per disegnare rettangoli. Perfetto per delimitare zone di campo.
                            </div>
                        </div>
                        <div class="tool-item">
                            <i class="fas fa-font"></i>
                            <div>
                                <strong>Testo:</strong> Clicca per aggiungere testo personalizzato. Puoi modificare colore e dimensione. Doppio clic per modificare testo esistente.
                            </div>
                        </div>
                        <div class="tool-item">
                            <i class="fas fa-pen"></i>
                            <div>
                                <strong>Penna:</strong> Disegno a mano libera. Clicca e trascina per creare linee curve e forme personalizzate.
                            </div>
                        </div>
                        <div class="tool-item">
                            <i class="fas fa-eraser"></i>
                            <div>
                                <strong>Gomma:</strong> Clicca e trascina per cancellare parti di disegni. Funziona su tutti gli elementi tattici.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="info-section">
                    <h3><i class="fas fa-cog"></i> Propriet√† e Personalizzazione</h3>
                    <div class="property-info">
                        <div class="property-item">
                            <strong>Colore:</strong> Cambia il colore di linee, frecce e forme prima di disegnarle.
                        </div>
                        <div class="property-item">
                            <strong>Spessore:</strong> Regola lo spessore delle linee da 1 a 10 pixel.
                        </div>
                        <div class="property-item">
                            <strong>Riempimento:</strong> Attiva per riempire cerchi e rettangoli con il colore selezionato.
                        </div>
                    </div>
                </div>

                <div class="info-section">
                    <h3><i class="fas fa-keyboard"></i> Scorciatoie da Tastiera</h3>
                    <div class="shortcuts-info">
                        <div class="shortcut-item">
                            <kbd>Canc</kbd> / <kbd>Backspace</kbd> - Elimina elemento selezionato
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl + Z</kbd> - Annulla ultima azione
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl + Y</kbd> - Ripeti azione annullata
                        </div>
                        <div class="shortcut-item">
                            <kbd>Esc</kbd> - Deseleziona elemento corrente
                        </div>
                    </div>
                </div>

                <div class="info-section">
                    <h3><i class="fas fa-tools"></i> Azioni Rapide</h3>
                    <div class="action-info">
                        <div class="action-item">
                            <i class="fas fa-undo"></i>
                            <div>
                                <strong>Annulla:</strong> Torna indietro di un'azione. Puoi annullare pi√π azioni consecutive.
                            </div>
                        </div>
                        <div class="action-item">
                            <i class="fas fa-redo"></i>
                            <div>
                                <strong>Ripeti:</strong> Ripete l'ultima azione annullata.
                            </div>
                        </div>
                        <div class="action-item">
                            <i class="fas fa-trash"></i>
                            <div>
                                <strong>Cancella Tutto:</strong> Rimuove tutti gli elementi tattici dal campo. <em>Attenzione: questa azione non pu√≤ essere annullata!</em>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="info-section">
                    <h3><i class="fas fa-lightbulb"></i> Suggerimenti</h3>
                    <div class="tips-info">
                        <div class="tip-item">
                            üí° <strong>Combinazioni:</strong> Usa frecce per i movimenti, cerchi per le posizioni chiave e testo per le note tattiche.
                        </div>
                        <div class="tip-item">
                            üí° <strong>Colori:</strong> Usa colori diversi per distinguere giocatori, ruoli o fasi di gioco.
                        </div>
                        <div class="tip-item">
                            üí° <strong>Precisione:</strong> Per linee perfettamente dritte, usa lo strumento Linea invece della Penna.
                        </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="tacticalInfoModalOk">
                    <i class="fas fa-check"></i>
                    Ho Capito
                </button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal" id="confirmationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="confirmationTitle">Conferma Azione</h3>
                <button type="button" class="modal-close" id="confirmationModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="confirmation-content">
                    <div class="confirmation-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <p id="confirmationMessage">Sei sicuro di voler procedere?</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="confirmationCancel">
                    <i class="fas fa-times"></i>
                    No, Annulla
                </button>
                <button type="button" class="btn btn-danger" id="confirmationConfirm">
                    <i class="fas fa-check"></i>
                    S√¨, Conferma
                </button>
            </div>
        </div>
    </div>

    <!-- Grid View Modal -->
    <div class="modal" id="gridViewModal">
        <div class="modal-content grid-modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-th"></i> Vista Griglia Giocatori</h2>
                <button type="button" class="btn-close" id="gridModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <!-- Grid Filters -->
                <div class="grid-filters">
                    <div class="filter-row">
                        <div class="form-group">
                            <label for="gridSquadFilter">Squadra</label>
                            <select id="gridSquadFilter">
                                <option value="">Tutte le squadre</option>
                                <option value="alpak">Alpak</option>
                                <option value="bigbro">Big Bro</option>
                                <option value="boomers">Boomers</option>
                                <option value="caesar">Caesar</option>
                                <option value="circus">Circus</option>
                                <option value="d power">D Power</option>
                                <option value="fc zeta">FC Zeta</option>
                                <option value="gear 7">Gear 7</option>
                                <option value="stallions">Stallions</option>
                                <option value="trm fc">TRM FC</option>
                                <option value="underdogs fc">Underdogs FC</option>
                                <option value="zebras fc">Zebras FC</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="gridNameFilter">Nome</label>
                            <input type="text" id="gridNameFilter" placeholder="Cerca giocatore...">
                        </div>
                        <div class="form-group">
                            <label for="gridPositionFilter">Posizione</label>
                            <select id="gridPositionFilter">
                                <option value="">Tutte le posizioni</option>
                                <option value="PORTIERE">PORTIERE</option>
                                <option value="DIFENSORE">DIFENSORE</option>
                                <option value="CENTROCAMPISTA">CENTROCAMPISTA</option>
                                <option value="ATTACCANTE">ATTACCANTE</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="gridRoleToggleBtn">Visualizza Ruoli</label>
                            <button id="gridRoleToggleBtn" class="role-toggle-btn" title="Mostra/Nascondi ruoli dei giocatori">
                                <i class="fas fa-eye"></i>
                                <span class="toggle-text">ON</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Selection Info -->
                <div class="selection-info">
                    <span class="selection-count">
                        <i class="fas fa-check-circle"></i>
                        <span id="selectedCount">0</span> giocatori selezionati
                    </span>
                    <div class="selection-actions">
                        <button class="btn btn-sm btn-secondary" id="selectAllBtn">
                            <i class="fas fa-check-double"></i>
                            Seleziona tutto
                        </button>
                        <button class="btn btn-sm btn-secondary" id="clearSelectionBtn">
                            <i class="fas fa-times"></i>
                            Deseleziona tutto
                        </button>
                    </div>
                </div>
                
                <!-- Grid Container -->
                <div class="grid-container" id="gridContainer">
                    <!-- Player cards will be dynamically added here -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="gridModalCancel">
                    <i class="fas fa-times"></i>
                    Annulla
                </button>
                <button type="button" class="btn btn-primary" id="gridModalInsert">
                    <i class="fas fa-plus"></i>
                    Inserisci in campo (<span id="insertCount">0</span>)
                </button>
            </div>
        </div>
    </div>

    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>



    <script src="button-feedback.js"></script>
    <script src="script.js"></script>
</body>
</html>